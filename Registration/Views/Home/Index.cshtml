@model Registration.Models.ViewModel

<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script type="text/javascript" charset="utf-8" src="http://cdn.sencha.io/ext-4.2.0-gpl/ext-all.js"></script>
<script type="text/javascript" src="../../UI/scripts/request.js"></script>
<link rel="stylesheet" type="text/css" href="../../UI/css/ext-all.css">
<link rel="stylesheet" type="text/css" href="../../UI/css/ext-all-gray.css">
<script>
    var uploadWindow = Ext.create('Ext.window.Window', {
        title: 'Upload file to database',
        height: 300,
        width: 300,
        renderTo: Ext.getBody(),
        modal: true,
        items: [{
            xtype: 'form',
            items: [{
                xtype: 'filefield',
                fieldLabel: 'Виберіть файл..',
                name: 'file'
            }],
            buttons: [{
                text: 'Завантажити',
                handler: function(btn) {
                    this.up('form').getForm().submit({
                        url: 'Home/Upload',
                        waitMsg: 'Uploading...',
                        method: 'POST',
                        success: function() {
                            var window = btn.up('window');
                            Ext.Msg.alert('Success', 'File uploaded successful', function(btn) {
                                if(btn == "ok") {
                                    window.close();
                                }
                            });
                        }
                    });
                }
            }]
        }]
    }); 
    Ext.application({
        name: 'MyApp',
        launch: function () {
            Ext.create('Ext.tab.Panel', {
                id: 'tabpanel',
                style: 'margin:100px auto; ',
                width: 600,
                tabBarPosition: 'bottom',
                renderTo: Ext.getBody(),
                items: [{
                    title: 'Введення даних',
                    items: [
                        {
                            xtype: 'button',
                            margin: '20',
                            text: 'Переглянути історію',
                            handler: function () {
                                location.href = "/Home/History"
                            }
                        }, {
                            xtype: 'button',
                            margin: '20',
                            text: 'Завантажити дані з файлу',
                            handler: function () {
                                uploadWindow.show();
                            }
                        },
                        {
                            xtype: 'form',
                            padding: '10',
                            layout: 'hbox',
                            items: [
                            {
                                xtype: 'container',
                                margin: '20',
                                defaults: {
                                    allowBlank: false
                                },
                                items: [
                                    {
                                        xtype: 'textfield',
                                        fieldLabel: 'Тиск на вході',
                                        name: 'first.pressIn'
                                    }, {
                                        xtype: 'textfield',
                                        fieldLabel: 'Тиск на виході',
                                        name: 'first.pressOut'
                                    }, {
                                        xtype: 'textfield',
                                        fieldLabel: 'Enter smth',
                                        name: 'first.power'
                                    }, {
                                        xtype: 'textfield',
                                        fieldLabel: 'Enter smth',
                                        name: 'first.performance'
                                    }
                                ]
                            }, {
                                xtype: 'container',
                                margin: '20',
                                defaults: {
                                    allowBlank: false
                                },
                                items: [
	                                    {
	                                        xtype: 'textfield',
	                                        fieldLabel: 'Тиск на вході',
	                                        name: 'first.pressIn'
	                                    }, {
	                                        xtype: 'textfield',
	                                        fieldLabel: 'Тиск на виході',
	                                        name: 'first.pressOut'
	                                    }, {
	                                        xtype: 'combo',
	                                        displayField: 'name',
	                                        name: 'second.chooseRodo',
	                                        fieldLabel: 'Виберіть родовище',
	                                        store: Ext.create('Ext.data.Store', {
	                                            fields: ['value', 'name'],
	                                            data: [{ value: 1, name: 'First' }, { value: 1, name: 'First'}]
	                                        })
	                                    }, {
	                                        xtype: 'container',
	                                        width: 200,
	                                        fieldLabel: 'Size',
	                                        defaultType: 'radiofield',
	                                        defaults: {
	                                            flex: 1
	                                        },
	                                        layout: 'hbox',
	                                        items: [
                                            {
                                                boxLabel: 'Кущ',
                                                name: 'second.bushSverd',
                                                inputValue: 'kusch',
                                                id: 'radio1'
                                            }, {
                                                boxLabel: 'Свердловина',
                                                name: 'second.bushSverd',
                                                inputValue: 'sver',
                                                id: 'radio2'
                                            }
                                        ]

	                                    }
	                                ]
                            }
                            ],
                            buttons: [
                                { text: 'Submit', handler: function (btn) {
                                    var form = this.up('form');
                                    if(form.isValid()){
                                        Ext.getBody().mask('Please wait...');
                                        form.submit({
                                            method: 'POST',
                                            url: '/Home/SelectCompressor',
                                            success: function (response, res, btn) {
                                                Ext.getCmp('tabpanel').setActiveTab(1);
                                                Ext.getCmp("resultPanel").removeAll(true);
                                                var dataItems = new Array();
                                                for (var i = 0; i< res.result.resp.length; i++){
                                                            dataItems[i] = {
                                                            html : res.result.resp[i].PressOut , 
                                                            width: 580,
                                                            height: 200,
                                                            layout: {
                                                                type: 'hbox'
                                                            },
                                                            bodyStyle: {lineHeight: '160px'},
                                                            items:[{xtype: 'panel', html:'Type of the compressor', height:180, width: 180,style: { color: '#000',backgroundColor:'#BBB',borderRadius: 20,textAlign: 'center', border: '15px solid #6699CC', margin: 5}, bodyStyle: {background: '#BBB', lineHeight: '120px'}}], 
                                                            defaultMargins: 10, 
                                                            flex: 1, 
                                                            split: true,
                                                            style: { color: '#000',backgroundColor:'#FFF',borderRadius: 20,textAlign: 'center', border: '5px solid', margin: 5},
                            
                            
                                                        };
                                                    }
    //                                           
                                                Ext.getCmp('resultPanel').add(dataItems);
                                                Ext.getBody().unmask();
                                                }
                                        
                                        });
                                    }
                                }
                                },
                                { text: 'Cancel', handler: function() {this.up('form').getForm().reset();} },
                            ]

                        }]
                }, {
                    tabIndex: 2,
                    title: 'Результат',
                    id: 'resultPanel',
                    iconCls: 'user'
                }]
            });
        } // launch
    });           // application()
</script>